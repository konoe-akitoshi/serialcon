# SerialCon - シリアルコンソール接続補助ツール

SerialConは、Mac上でネットワーク機器等のシリアルコンソール接続を補助するシンプルなツールです。

## 機能

- 利用可能なシリアルポートの自動検出と表示
- カーソルを使った簡単なポート選択
- 自動ネゴシエーション機能（ボーレート等の自動検出）
- 文字エンコーディングの自動検出機能
- 手動設定オプション（ボーレート選択、エンコーディング選択）
- シリアルコンソールとのインタラクティブな通信
- Ciscoデバイス向けのデフォルト設定（9600ボー、UTF-8）

## インストール方法

### ビルド済みバイナリを使用する場合

1. [リリースページ](https://github.com/akitoshi/serialcon/releases)から最新のバイナリをダウンロード
2. ダウンロードしたファイルを実行可能にする：
   ```
   chmod +x serialcon
   ```
3. 必要に応じてパスの通った場所に移動する：
   ```
   sudo mv serialcon /usr/local/bin/
   ```

### ソースからビルドする場合

1. リポジトリをクローン：
   ```
   git clone https://github.com/konoe-akitoshi/serialcon.git
   cd serialcon
   ```

2. ビルドスクリプトを実行：
   ```
   ./build.sh
   ```

3. インストールスクリプトを実行：
   ```
   sudo ./install.sh
   ```

これにより、バイナリがビルドされ、`/usr/local/bin/` にインストールされます。

## 使い方

### 基本的な使い方

1. ターミナルで `serialcon` コマンドを実行
2. 利用可能なシリアルポートの一覧が表示される
3. カーソルキーでポートを選択し、Enterキーで接続
4. デフォルトでは自動ネゴシエーションとエンコーディング自動検出が有効になっており、適切な設定を自動検出
5. 必要に応じて自動ネゴシエーションや自動エンコーディング検出を無効にして手動設定も可能
6. 接続後はシリアルコンソールとインタラクティブに通信可能
7. 終了するには Ctrl+C を押す

### ログ機能の使用方法

シリアルコンソールの出力をログファイルに保存することができます：

```
serialcon -log ./logs/session.log
```

ログファイルには以下の情報が記録されます：
- セッション開始時刻
- 接続情報（ポート、ボーレート、エンコーディング）
- シリアルコンソールの全出力

ログディレクトリが存在しない場合は自動的に作成されます。

## 設定オプション

### UI設定

- **自動ネゴシエーション**: 有効にすると、適切なボーレートを自動検出します
  - 複数のボーレート（9600, 115200, 19200, 38400, 57600, 4800, 2400, 1200）を試行
  - スコアリングシステムにより最適なボーレートを選択
  - 複数のテストコマンドを送信して応答を評価
  - プロンプト文字（>、#、$など）や可読文字の割合を分析
  - 詳細なログ出力で検出プロセスを確認可能
- **エンコーディング自動検出**: 有効にすると、接続先デバイスの文字エンコーディングを自動検出します
  - 接続時に受信したデータを分析し、最適なエンコーディングを選択
  - RTX1210などの日本語を含むデバイスでも文字化けを防止
- **ボーレート**: 自動ネゴシエーションを無効にした場合に使用するボーレートを選択できます
  - デフォルトは9600（Ciscoデバイス向け）
  - その他: 19200, 38400, 57600, 115200
- **エンコーディング**: エンコーディング自動検出を無効にした場合に使用するエンコーディングを選択できます
  - UTF-8: デフォルト設定（Ciscoデバイス向け）
  - Shift-JIS: 日本語Windows等で一般的なエンコーディング
  - EUC-JP: 日本語UNIX/Linux等で使用されるエンコーディング
  - ISO-2022-JP: 日本語電子メール等で使用されるエンコーディング

### コマンドラインオプション

- **-log**: ログファイルのパスを指定します
  ```
  serialcon -log ./logs/session.log
  ```

## アップデート方法

### アップデートスクリプトを使用する方法（推奨）

リポジトリには、簡単にアップデートを行うための `update.sh` スクリプトが含まれています：

```
cd serialcon  # リポジトリのディレクトリに移動
./update.sh
```

このスクリプトは以下の処理を自動的に行います：
- リポジトリの最新化（git pull）
- バイナリの再ビルド
- システムへの再インストール

### 手動でアップデートする方法

1. リポジトリを最新の状態に更新：
   ```
   cd serialcon
   git pull
   ```

2. 再ビルド：
   ```
   ./build.sh
   ```
   または
   ```
   go build -o serialcon
   ```

3. 再インストール：
   ```
   sudo ./install.sh
   ```
   または
   ```
   sudo mv serialcon /usr/local/bin/
   ```

## 注意事項

- シリアルポートへのアクセス権限が必要な場合があります
- USBシリアル変換アダプタを使用する場合は、適切なドライバがインストールされていることを確認してください
